<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Fridge Alarm: /home/travis/build/dea82/FridgeAlarm/README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fridge Alarm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/home/travis/build/dea82/FridgeAlarm/README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="README_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor"># FridgeAlarm</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">## System overview</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span>Alarm system <span class="keywordflow">for</span> unintentionally open fridge door</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">## Requirements</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">## Design</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor"></span><span class="preprocessor">### Component selection</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">### Box design</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">### PCB</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">### Software</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span>[Doxygen documentation](http:<span class="comment">//dea82.github.io/FridgeAlarm)</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#### Doxygen deployment by Travis</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor"></span>The source code documentation is generated with [Doxygen](http:<span class="comment">//www.doxygen.com) and pushed automatically to GitHub Pages by [Travis CI](http://www.travis-ci.org).</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">##### Setup</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span>This assumes that you<span class="stringliteral">&#39;ve already figures out how to genereate Doxygen documentation and are able to build with Travis CI.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="stringliteral">To be able to automatically update Doxygen documentation when a commit is done to GitHub follow these steps:</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="stringliteral">###### Generation of SSH-key</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="stringliteral">1. Generate a new SSH key with the following command: </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="stringliteral">`ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;`</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="stringliteral">2. You are then prompted to enter a name for the new keypair. Enter a file in which to save the key.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral">3. When asked for passphrase just press ENTER for empty passphrase. Confirm with ENTER again.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="stringliteral">###### Setup GitHub</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="stringliteral">1. Navigate to your GitHub settings page `https://github.com/&lt;username&gt;/&lt;your_repository&gt;/settings/keys` and paste the content from the public ssh-key file, the one ending with .pub. **Make sure to check the box that allows write access!**</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="stringliteral">###### Setup Travis CI</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="stringliteral">This is the trickiest part.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">1. Make sure you&#39;</span>re able to connect to Travis console.</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;2. Run command: `travis encrypt-file name-of-key-generated`.</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;It<span class="stringliteral">&#39;s the key that doesn&#39;</span>t end with .pub that shall be used.</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;3. You <span class="keyword">get</span> an instruction from Travis CI. As it says you should now make sure to add the returned key, ending with .enc, to your repository. All others keys can and should now be removed!</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;4. Next update your .travis.yml with the encryption label, the 12-digit hex value returned from step 2.</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;```</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;env:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    global:</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        - ENCRYPTION_LABEL: <span class="stringliteral">&quot;12-digit hex value&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;```</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;TODO: Finalize</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;https:<span class="comment">//gist.github.com/domenic/ec8b0fc8ab45f39403dd</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">## Verification</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">### Install</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor"></span>To upload the hex-file to the MCU (Attiny85) I use the following command with avrdude:</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;`avrdude -B250 -cusbasp -pt85 -Uflash:w:&lt;path to hex file&gt; -Ulfuse:w:0xE2:m -Uhfuse:w:0x55:m`</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;The -B250 makes it slow - however if the clock of the MCU is to slow it might not work otherwise.</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#### Fuses</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor"></span>|MCU      |Low fuse|High fuse|</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;|---------|:------:|:-------:|</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;|Attiny13A|0x7A    |0xFA     |</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;|Attiny85 |0xE2    |0x55     |</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">### Power consumption</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"></span>The following current consumption has been observed with prototype pcb, Attiny85 and magnetic buzzer.</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;System mode      |Current consumption [mA]</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;-----------------|:-----------------------:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;Buzzer and LED ON|42</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;LED ON           |2.3</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Deep sleep       |0.024</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;The following current consumption has been observed with production pcb, Attiny13A and piezo buzzer.</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;System mode      |Current consumption [mA]</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;-----------------|:-----------------------:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;Buzzer and LED ON|5</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;LED ON           |2.2</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;Deep sleep       |0.024</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;## Conclusion</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
