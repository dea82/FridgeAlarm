---
sudo: required
dist: trusty

language: c

before_install:
  - sudo apt-get update -qq
install:
  - sudo apt-get install -qq gcc-avr binutils-avr avr-libc doxygen graphviz

env:
  global:
  # Used for deployment
  - ENCRYPTION_LABEL: "992952f03676"
  - COMMIT_AUTHOR_EMAIL: "andreas.laghamn@gmail.com"

script: 
  - make -C src MCU_TARGET=attiny13a F_CPU=9600000
  - make -C src MCU_TARGET=attiny85 F_CPU=8000000
  - make -C src clean
  # Attiny does not have a Timer1 => CPU_LOAD impossible
  - make -C src MCU_TARGET=attiny13a F_CPU=9600000 DEBUG_ENABLE=1 CPU_LOAD=0 BAUD_RATE=57600
  - make -C src MCU_TARGET=attiny85 F_CPU=8000000 DEBUG_ENABLE=1 CPU_LOAD=1 BAUD_RATE=57600
  # Deploy doxygen documentation to GitHub Pages
  - ./.deployment/travis/doxygen.sh